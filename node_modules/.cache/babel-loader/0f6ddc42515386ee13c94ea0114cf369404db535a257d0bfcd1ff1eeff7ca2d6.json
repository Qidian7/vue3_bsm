{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nvar util = require(\"../core/util\");\nvar _event = require(\"../core/event\");\nvar Dispatcher = _event.Dispatcher;\nvar requestAnimationFrame = require(\"./requestAnimationFrame\");\nvar Animator = require(\"./Animator\");\n\n/**\n * Animation main class, dispatch and manage all animation controllers\n *\n * @module zrender/animation/Animation\n * @author pissang(https://github.com/pissang)\n */\n// TODO Additive animation\n// http://iosoteric.com/additive-animations-animatewithduration-in-ios-8/\n// https://developer.apple.com/videos/wwdc2014/#236\n\n/**\n * @typedef {Object} IZRenderStage\n * @property {Function} update\n */\n\n/**\n * @alias module:zrender/animation/Animation\n * @constructor\n * @param {Object} [options]\n * @param {Function} [options.onframe]\n * @param {IZRenderStage} [options.stage]\n * @example\n *     var animation = new Animation();\n *     var obj = {\n *         x: 100,\n *         y: 100\n *     };\n *     animation.animate(node.position)\n *         .when(1000, {\n *             x: 500,\n *             y: 500\n *         })\n *         .when(2000, {\n *             x: 100,\n *             y: 100\n *         })\n *         .start('spline');\n */\nvar Animation = function (options) {\n  options = options || {};\n  this.stage = options.stage || {};\n  this.onframe = options.onframe || function () {}; // private properties\n\n  this._clips = [];\n  this._running = false;\n  this._time;\n  this._pausedTime;\n  this._pauseStart;\n  this._paused = false;\n  Dispatcher.call(this);\n};\nAnimation.prototype = {\n  constructor: Animation,\n  /**\n   * Add clip\n   * @param {module:zrender/animation/Clip} clip\n   */\n  addClip: function (clip) {\n    this._clips.push(clip);\n  },\n  /**\n   * Add animator\n   * @param {module:zrender/animation/Animator} animator\n   */\n  addAnimator: function (animator) {\n    animator.animation = this;\n    var clips = animator.getClips();\n    for (var i = 0; i < clips.length; i++) {\n      this.addClip(clips[i]);\n    }\n  },\n  /**\n   * Delete animation clip\n   * @param {module:zrender/animation/Clip} clip\n   */\n  removeClip: function (clip) {\n    var idx = util.indexOf(this._clips, clip);\n    if (idx >= 0) {\n      this._clips.splice(idx, 1);\n    }\n  },\n  /**\n   * Delete animation clip\n   * @param {module:zrender/animation/Animator} animator\n   */\n  removeAnimator: function (animator) {\n    var clips = animator.getClips();\n    for (var i = 0; i < clips.length; i++) {\n      this.removeClip(clips[i]);\n    }\n    animator.animation = null;\n  },\n  _update: function () {\n    var time = new Date().getTime() - this._pausedTime;\n    var delta = time - this._time;\n    var clips = this._clips;\n    var len = clips.length;\n    var deferredEvents = [];\n    var deferredClips = [];\n    for (var i = 0; i < len; i++) {\n      var clip = clips[i];\n      var e = clip.step(time, delta); // Throw out the events need to be called after\n      // stage.update, like destroy\n\n      if (e) {\n        deferredEvents.push(e);\n        deferredClips.push(clip);\n      }\n    } // Remove the finished clip\n\n    for (var i = 0; i < len;) {\n      if (clips[i]._needsRemove) {\n        clips[i] = clips[len - 1];\n        clips.pop();\n        len--;\n      } else {\n        i++;\n      }\n    }\n    len = deferredEvents.length;\n    for (var i = 0; i < len; i++) {\n      deferredClips[i].fire(deferredEvents[i]);\n    }\n    this._time = time;\n    this.onframe(delta); // 'frame' should be triggered before stage, because upper application\n    // depends on the sequence (e.g., echarts-stream and finish\n    // event judge)\n\n    this.trigger('frame', delta);\n    if (this.stage.update) {\n      this.stage.update();\n    }\n  },\n  _startLoop: function () {\n    var self = this;\n    this._running = true;\n    function step() {\n      if (self._running) {\n        requestAnimationFrame(step);\n        !self._paused && self._update();\n      }\n    }\n    requestAnimationFrame(step);\n  },\n  /**\n   * Start animation.\n   */\n  start: function () {\n    this._time = new Date().getTime();\n    this._pausedTime = 0;\n    this._startLoop();\n  },\n  /**\n   * Stop animation.\n   */\n  stop: function () {\n    this._running = false;\n  },\n  /**\n   * Pause animation.\n   */\n  pause: function () {\n    if (!this._paused) {\n      this._pauseStart = new Date().getTime();\n      this._paused = true;\n    }\n  },\n  /**\n   * Resume animation.\n   */\n  resume: function () {\n    if (this._paused) {\n      this._pausedTime += new Date().getTime() - this._pauseStart;\n      this._paused = false;\n    }\n  },\n  /**\n   * Clear animation.\n   */\n  clear: function () {\n    this._clips = [];\n  },\n  /**\n   * Whether animation finished.\n   */\n  isFinished: function () {\n    return !this._clips.length;\n  },\n  /**\n   * Creat animator for a target, whose props can be animated.\n   *\n   * @param  {Object} target\n   * @param  {Object} options\n   * @param  {boolean} [options.loop=false] Whether loop animation.\n   * @param  {Function} [options.getter=null] Get value from target.\n   * @param  {Function} [options.setter=null] Set value to target.\n   * @return {module:zrender/animation/Animation~Animator}\n   */\n  // TODO Gap\n  animate: function (target, options) {\n    options = options || {};\n    var animator = new Animator(target, options.loop, options.getter, options.setter);\n    this.addAnimator(animator);\n    return animator;\n  }\n};\nutil.mixin(Animation, Dispatcher);\nvar _default = Animation;\nmodule.exports = _default;","map":{"version":3,"names":["util","require","_event","Dispatcher","requestAnimationFrame","Animator","Animation","options","stage","onframe","_clips","_running","_time","_pausedTime","_pauseStart","_paused","call","prototype","constructor","addClip","clip","push","addAnimator","animator","animation","clips","getClips","i","length","removeClip","idx","indexOf","splice","removeAnimator","_update","time","Date","getTime","delta","len","deferredEvents","deferredClips","e","step","_needsRemove","pop","fire","trigger","update","_startLoop","self","start","stop","pause","resume","clear","isFinished","animate","target","loop","getter","setter","mixin","_default","module","exports"],"sources":["/Users/mac/Desktop/vue_bsm/vue3_bsm/node_modules/zrender/lib/animation/Animation.js"],"sourcesContent":["var util = require(\"../core/util\");\n\nvar _event = require(\"../core/event\");\n\nvar Dispatcher = _event.Dispatcher;\n\nvar requestAnimationFrame = require(\"./requestAnimationFrame\");\n\nvar Animator = require(\"./Animator\");\n\n/**\n * Animation main class, dispatch and manage all animation controllers\n *\n * @module zrender/animation/Animation\n * @author pissang(https://github.com/pissang)\n */\n// TODO Additive animation\n// http://iosoteric.com/additive-animations-animatewithduration-in-ios-8/\n// https://developer.apple.com/videos/wwdc2014/#236\n\n/**\n * @typedef {Object} IZRenderStage\n * @property {Function} update\n */\n\n/**\n * @alias module:zrender/animation/Animation\n * @constructor\n * @param {Object} [options]\n * @param {Function} [options.onframe]\n * @param {IZRenderStage} [options.stage]\n * @example\n *     var animation = new Animation();\n *     var obj = {\n *         x: 100,\n *         y: 100\n *     };\n *     animation.animate(node.position)\n *         .when(1000, {\n *             x: 500,\n *             y: 500\n *         })\n *         .when(2000, {\n *             x: 100,\n *             y: 100\n *         })\n *         .start('spline');\n */\nvar Animation = function (options) {\n  options = options || {};\n  this.stage = options.stage || {};\n\n  this.onframe = options.onframe || function () {}; // private properties\n\n\n  this._clips = [];\n  this._running = false;\n  this._time;\n  this._pausedTime;\n  this._pauseStart;\n  this._paused = false;\n  Dispatcher.call(this);\n};\n\nAnimation.prototype = {\n  constructor: Animation,\n\n  /**\n   * Add clip\n   * @param {module:zrender/animation/Clip} clip\n   */\n  addClip: function (clip) {\n    this._clips.push(clip);\n  },\n\n  /**\n   * Add animator\n   * @param {module:zrender/animation/Animator} animator\n   */\n  addAnimator: function (animator) {\n    animator.animation = this;\n    var clips = animator.getClips();\n\n    for (var i = 0; i < clips.length; i++) {\n      this.addClip(clips[i]);\n    }\n  },\n\n  /**\n   * Delete animation clip\n   * @param {module:zrender/animation/Clip} clip\n   */\n  removeClip: function (clip) {\n    var idx = util.indexOf(this._clips, clip);\n\n    if (idx >= 0) {\n      this._clips.splice(idx, 1);\n    }\n  },\n\n  /**\n   * Delete animation clip\n   * @param {module:zrender/animation/Animator} animator\n   */\n  removeAnimator: function (animator) {\n    var clips = animator.getClips();\n\n    for (var i = 0; i < clips.length; i++) {\n      this.removeClip(clips[i]);\n    }\n\n    animator.animation = null;\n  },\n  _update: function () {\n    var time = new Date().getTime() - this._pausedTime;\n\n    var delta = time - this._time;\n    var clips = this._clips;\n    var len = clips.length;\n    var deferredEvents = [];\n    var deferredClips = [];\n\n    for (var i = 0; i < len; i++) {\n      var clip = clips[i];\n      var e = clip.step(time, delta); // Throw out the events need to be called after\n      // stage.update, like destroy\n\n      if (e) {\n        deferredEvents.push(e);\n        deferredClips.push(clip);\n      }\n    } // Remove the finished clip\n\n\n    for (var i = 0; i < len;) {\n      if (clips[i]._needsRemove) {\n        clips[i] = clips[len - 1];\n        clips.pop();\n        len--;\n      } else {\n        i++;\n      }\n    }\n\n    len = deferredEvents.length;\n\n    for (var i = 0; i < len; i++) {\n      deferredClips[i].fire(deferredEvents[i]);\n    }\n\n    this._time = time;\n    this.onframe(delta); // 'frame' should be triggered before stage, because upper application\n    // depends on the sequence (e.g., echarts-stream and finish\n    // event judge)\n\n    this.trigger('frame', delta);\n\n    if (this.stage.update) {\n      this.stage.update();\n    }\n  },\n  _startLoop: function () {\n    var self = this;\n    this._running = true;\n\n    function step() {\n      if (self._running) {\n        requestAnimationFrame(step);\n        !self._paused && self._update();\n      }\n    }\n\n    requestAnimationFrame(step);\n  },\n\n  /**\n   * Start animation.\n   */\n  start: function () {\n    this._time = new Date().getTime();\n    this._pausedTime = 0;\n\n    this._startLoop();\n  },\n\n  /**\n   * Stop animation.\n   */\n  stop: function () {\n    this._running = false;\n  },\n\n  /**\n   * Pause animation.\n   */\n  pause: function () {\n    if (!this._paused) {\n      this._pauseStart = new Date().getTime();\n      this._paused = true;\n    }\n  },\n\n  /**\n   * Resume animation.\n   */\n  resume: function () {\n    if (this._paused) {\n      this._pausedTime += new Date().getTime() - this._pauseStart;\n      this._paused = false;\n    }\n  },\n\n  /**\n   * Clear animation.\n   */\n  clear: function () {\n    this._clips = [];\n  },\n\n  /**\n   * Whether animation finished.\n   */\n  isFinished: function () {\n    return !this._clips.length;\n  },\n\n  /**\n   * Creat animator for a target, whose props can be animated.\n   *\n   * @param  {Object} target\n   * @param  {Object} options\n   * @param  {boolean} [options.loop=false] Whether loop animation.\n   * @param  {Function} [options.getter=null] Get value from target.\n   * @param  {Function} [options.setter=null] Set value to target.\n   * @return {module:zrender/animation/Animation~Animator}\n   */\n  // TODO Gap\n  animate: function (target, options) {\n    options = options || {};\n    var animator = new Animator(target, options.loop, options.getter, options.setter);\n    this.addAnimator(animator);\n    return animator;\n  }\n};\nutil.mixin(Animation, Dispatcher);\nvar _default = Animation;\nmodule.exports = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}