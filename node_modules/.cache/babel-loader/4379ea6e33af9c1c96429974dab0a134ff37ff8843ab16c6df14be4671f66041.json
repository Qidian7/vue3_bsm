{"ast":null,"code":"var easingFuncs = require(\"./easing\");\n\n/**\n * 动画主控制器\n * @config target 动画对象，可以是数组，如果是数组的话会批量分发onframe等事件\n * @config life(1000) 动画时长\n * @config delay(0) 动画延迟时间\n * @config loop(true)\n * @config gap(0) 循环的间隔时间\n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\nfunction Clip(options) {\n  this._target = options.target; // 生命周期\n\n  this._life = options.life || 1000; // 延时\n\n  this._delay = options.delay || 0; // 开始时间\n  // this._startTime = new Date().getTime() + this._delay;// 单位毫秒\n\n  this._initialized = false; // 是否循环\n\n  this.loop = options.loop == null ? false : options.loop;\n  this.gap = options.gap || 0;\n  this.easing = options.easing || 'Linear';\n  this.onframe = options.onframe;\n  this.ondestroy = options.ondestroy;\n  this.onrestart = options.onrestart;\n  this._pausedTime = 0;\n  this._paused = false;\n}\nClip.prototype = {\n  constructor: Clip,\n  step: function (globalTime, deltaTime) {\n    // Set startTime on first step, or _startTime may has milleseconds different between clips\n    // PENDING\n    if (!this._initialized) {\n      this._startTime = globalTime + this._delay;\n      this._initialized = true;\n    }\n    if (this._paused) {\n      this._pausedTime += deltaTime;\n      return;\n    }\n    var percent = (globalTime - this._startTime - this._pausedTime) / this._life; // 还没开始\n\n    if (percent < 0) {\n      return;\n    }\n    percent = Math.min(percent, 1);\n    var easing = this.easing;\n    var easingFunc = typeof easing === 'string' ? easingFuncs[easing] : easing;\n    var schedule = typeof easingFunc === 'function' ? easingFunc(percent) : percent;\n    this.fire('frame', schedule); // 结束\n\n    if (percent === 1) {\n      if (this.loop) {\n        this.restart(globalTime); // 重新开始周期\n        // 抛出而不是直接调用事件直到 stage.update 后再统一调用这些事件\n\n        return 'restart';\n      } // 动画完成将这个控制器标识为待删除\n      // 在Animation.update中进行批量删除\n\n      this._needsRemove = true;\n      return 'destroy';\n    }\n    return null;\n  },\n  restart: function (globalTime) {\n    var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n    this._startTime = globalTime - remainder + this.gap;\n    this._pausedTime = 0;\n    this._needsRemove = false;\n  },\n  fire: function (eventType, arg) {\n    eventType = 'on' + eventType;\n    if (this[eventType]) {\n      this[eventType](this._target, arg);\n    }\n  },\n  pause: function () {\n    this._paused = true;\n  },\n  resume: function () {\n    this._paused = false;\n  }\n};\nvar _default = Clip;\nmodule.exports = _default;","map":{"version":3,"names":["easingFuncs","require","Clip","options","_target","target","_life","life","_delay","delay","_initialized","loop","gap","easing","onframe","ondestroy","onrestart","_pausedTime","_paused","prototype","constructor","step","globalTime","deltaTime","_startTime","percent","Math","min","easingFunc","schedule","fire","restart","_needsRemove","remainder","eventType","arg","pause","resume","_default","module","exports"],"sources":["/Users/mac/Desktop/vue_bsm/vue3_bsm/node_modules/zrender/lib/animation/Clip.js"],"sourcesContent":["var easingFuncs = require(\"./easing\");\n\n/**\n * 动画主控制器\n * @config target 动画对象，可以是数组，如果是数组的话会批量分发onframe等事件\n * @config life(1000) 动画时长\n * @config delay(0) 动画延迟时间\n * @config loop(true)\n * @config gap(0) 循环的间隔时间\n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\nfunction Clip(options) {\n  this._target = options.target; // 生命周期\n\n  this._life = options.life || 1000; // 延时\n\n  this._delay = options.delay || 0; // 开始时间\n  // this._startTime = new Date().getTime() + this._delay;// 单位毫秒\n\n  this._initialized = false; // 是否循环\n\n  this.loop = options.loop == null ? false : options.loop;\n  this.gap = options.gap || 0;\n  this.easing = options.easing || 'Linear';\n  this.onframe = options.onframe;\n  this.ondestroy = options.ondestroy;\n  this.onrestart = options.onrestart;\n  this._pausedTime = 0;\n  this._paused = false;\n}\n\nClip.prototype = {\n  constructor: Clip,\n  step: function (globalTime, deltaTime) {\n    // Set startTime on first step, or _startTime may has milleseconds different between clips\n    // PENDING\n    if (!this._initialized) {\n      this._startTime = globalTime + this._delay;\n      this._initialized = true;\n    }\n\n    if (this._paused) {\n      this._pausedTime += deltaTime;\n      return;\n    }\n\n    var percent = (globalTime - this._startTime - this._pausedTime) / this._life; // 还没开始\n\n    if (percent < 0) {\n      return;\n    }\n\n    percent = Math.min(percent, 1);\n    var easing = this.easing;\n    var easingFunc = typeof easing === 'string' ? easingFuncs[easing] : easing;\n    var schedule = typeof easingFunc === 'function' ? easingFunc(percent) : percent;\n    this.fire('frame', schedule); // 结束\n\n    if (percent === 1) {\n      if (this.loop) {\n        this.restart(globalTime); // 重新开始周期\n        // 抛出而不是直接调用事件直到 stage.update 后再统一调用这些事件\n\n        return 'restart';\n      } // 动画完成将这个控制器标识为待删除\n      // 在Animation.update中进行批量删除\n\n\n      this._needsRemove = true;\n      return 'destroy';\n    }\n\n    return null;\n  },\n  restart: function (globalTime) {\n    var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n    this._startTime = globalTime - remainder + this.gap;\n    this._pausedTime = 0;\n    this._needsRemove = false;\n  },\n  fire: function (eventType, arg) {\n    eventType = 'on' + eventType;\n\n    if (this[eventType]) {\n      this[eventType](this._target, arg);\n    }\n  },\n  pause: function () {\n    this._paused = true;\n  },\n  resume: function () {\n    this._paused = false;\n  }\n};\nvar _default = Clip;\nmodule.exports = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}